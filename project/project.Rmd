---
title: "project_code"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
data <- read.table("data.txt", header = T, row.names = 1)
(data)
(time <- seq(from = 0, to = 190, by = 10))
plot(time, data[,1], type="o", col="blue", pch="o", lty=1, ylim=c(0, 0.12), xlim=c(0,200), ylab="", main = "Gene Expression data")

points(time, data[,2], col="red", pch="*")
lines(time, data[,2], col="red",lty=2)

points(time, data[,3], col="black",pch="+")
lines(time, data[,3], col="black", lty=3)
 
points(time, data[,4], col="orange",pch="-")
lines(time, data[,4], col="orange", lty=4)

points(time, data[,5], col="green",pch="o")
lines(time, data[,5], col="green", lty=5)

legend(160,0.08,legend=c("SWI5","CBF1","GAL4", "GAL80", "ASH1"), col=c("blue","red","black"   ,"orange", "green"),pch=c("o","*","+", '-', "o"),lty=c(1,2,3,4,5), ncol=1)
```

```{r}
library(BiocManager)
library(minet)
library(infotheo)
library("graph")
library("bnlearn")
```

```{r}
# Inference
(mr <- minet(data, method="mrnet", estimator="mi.mm", disc="equalfreq"))
(ar <- minet( data, method="aracne", estimator="mi.mm", disc="equalwidth"))
(clr<- minet( data, method="clr", estimator="mi.mm", disc="equalwidth"))
gr_mr <- as(mr, "graphNEL")
gr_clr <- as(clr, "graphNEL")
gr_ar <- as(ar, "graphNEL")

dim_names <- c("SWI5","CBF1","GAL4", "GAL80", "ASH1")
mat_data <- c(0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0)
(true_adj_mat <- matrix(mat_data, nrow=5, ncol=5, dimnames = list(dim_names, dim_names)))

mr.tbl <- minet::validate(mr, true_adj_mat)
ar.tbl <- minet::validate(ar, true_adj_mat)
clr.tbl <- minet::validate(clr, true_adj_mat)

show.roc(mr.tbl, col="green", type="b")
#show.roc(ar.tbl, col="blue", type="b")
#show.roc(clr.tbl, col="red", type="b")

plot(gr_mr, main = "MRNET")
#plot(gr_ar, main = "ARACNE")
#plot(gr_clr, main = "CLR")

```

```{r}
disc_data <- discretize(data)
bn.hc <- bnlearn::hc(data)
(bn.hc)
plot(bn.hc, main = "Hill-Climbing")
bn.iamb <- bnlearn::iamb(data)
plot(bn.iamb, main = "Incremental Association")
```

```{r}
library("GeneNet")
data_long <- as.longitudinal(as.matrix(data))
(data_long)
```

```{r}
library("GENIE3")
library(igraph)
(weightMatrix <- GENIE3(t(as.matrix(data)), returnMatrix=TRUE))
linkList <- getLinkList(weightMatrix)
(linkList)
(gr_mr <- as(weightMatrix, "graphNEL"))
eg <- graph_from_data_frame(linkList, directed=TRUE)
g <- graph_from_adjacency_matrix(weightMatrix, mode="max", weighted=T)
genie <- minet::validate(weightMatrix, true_adj_mat)
minet::show.roc(genie, col="green", type="b")
plot(g, edge.width=E(g)$weight, main="GENIE3")
```
